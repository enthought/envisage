<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Extensibility &mdash; Envisage Documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '4.4.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/et.ico"/>
    <link rel="top" title="Envisage Documentation" href="../index.html" />
    <link rel="up" title="Tasks User Manual" href="index.html" />
    <link rel="prev" title="Menus and Tool Bars" href="menus.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="menus.html" title="Menus and Tool Bars"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Envisage Documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Tasks User Manual</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="extensibility">
<span id="id1"></span><h1>Extensibility<a class="headerlink" href="#extensibility" title="Permalink to this headline">¶</a></h1>
<p id="index-0">The foregoing sections have described those elements of the Tasks framework that
belong to the PyFace project; as such, our imports have been from the
<tt class="docutils literal"><span class="pre">pyface.tasks</span></tt> package. We now discuss how Tasks can be used in
conjunction with Envisage to build extensible applications. Accordingly, our
imports in this section will be from the <tt class="docutils literal"><span class="pre">envisage.ui.tasks</span></tt>
package.</p>
<p>As remarked in the <a class="reference internal" href="intro.html#introduction"><em>Introduction</em></a>, some familiarity with the Envisage
plugin framework is assumed. For more information about Envisage, the reader is
referred to the <a class="reference internal" href="../envisage_core_documentation/index.html"><em>Envisage Core Documentation</em></a>.</p>
<div class="section" id="the-tasks-plugin">
<span id="tasks-plugin"></span><h2>The Tasks Plugin<a class="headerlink" href="#the-tasks-plugin" title="Permalink to this headline">¶</a></h2>
<p>In creating an extensible Tasks application, we imagine two primary
extensibility use cases:</p>
<ol class="arabic">
<li><p class="first"><strong>Contributing to an existing task:</strong></p>
<p>In this case, the user wishes to add some combination of dock panes, menu
items, and tool bar buttons to an existing task. In other words, the user
would like to extend a task&#8217;s functionality without changing its fundamental
purpose.</p>
</li>
<li><p class="first"><strong>Contributing a new task:</strong></p>
<p>Alternatively, the user may find that the none of the existing tasks are
suitable for the functonality that he or she wishes to implement. Thus the
user decides to contribute an entirely new task.</p>
</li>
</ol>
<p>The Tasks plugin has an extension point corresponding to each of these two use
cases. These extensions points are:</p>
<ol class="arabic" id="index-1">
<li><p class="first"><tt class="docutils literal"><span class="pre">envisage.ui.tasks.tasks</span></tt>:</p>
<p>A list of <tt class="docutils literal"><span class="pre">TaskFactory</span></tt> instances. <tt class="docutils literal"><span class="pre">TaskFactory</span></tt> is a lightweight class
for associating a task factory with a name and an ID. We shall see an example
of its use in the following subsection.</p>
</li>
</ol>
<ol class="arabic" id="index-2" start="2">
<li><p class="first"><tt class="docutils literal"><span class="pre">envisage.ui.tasks.task_extensions</span></tt>:</p>
<p>A list of <tt class="docutils literal"><span class="pre">TaskExtension</span></tt> instances. A <tt class="docutils literal"><span class="pre">TaskExtension</span></tt> is a bundle of
menu bar, tool bar, and dock pane additions to an existing task. This class
is discussed in detail in the subsection on <a class="reference internal" href="#extending-a-task"><em>Extending an Existing Task</em></a>.</p>
</li>
</ol>
<p>The Tasks plugin also provides two extensions points that permit the
creation of extensible preferences dialogs. We defer discussion of this
functionality to the subsection on <a class="reference internal" href="#creating-a-preferences-dialog"><em>Creating a Preferences Dialog</em></a>.</p>
<span class="target" id="tasks-applications"></span></div>
<div class="section" id="creating-a-tasks-application">
<span id="index-3"></span><h2>Creating a Tasks Application<a class="headerlink" href="#creating-a-tasks-application" title="Permalink to this headline">¶</a></h2>
<p>Let us imagine that we are building a (slightly whimsical) application for
visualizing <a class="reference external" href="http://en.wikipedia.org/wiki/Attractor">strange attractors</a>, in
two and three dimensions <a class="footnote-reference" href="#id7" id="id2">[1]</a>. We take for granted the existence of tasks
for performing each of these two kinds of visualization.</p>
<p>Like any Envisage application, our application will contain a <tt class="docutils literal"><span class="pre">Plugin</span></tt>
instance to expose functionality to other plugins. In this case, we will
contribute our two tasks to the Tasks plugin. Because the Tasks plugin is
responsible for creating tasks and the windows that contain them, it expects to
receive <em>factories</em> for creating <tt class="docutils literal"><span class="pre">Task</span></tt> instances rather than the instances
themselves. The <tt class="docutils literal"><span class="pre">TaskFactory</span></tt> class fulfills this role.</p>
<p>With this in mind, we can define a <tt class="docutils literal"><span class="pre">Plugin</span></tt> for our application:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">AttractorsPlugin</span><span class="p">(</span><span class="n">Plugin</span><span class="p">):</span>

    <span class="c">#### &#39;IPlugin&#39; interface ##############################################</span>

    <span class="c"># The plugin&#39;s unique identifier.</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="s">&#39;example.attractors&#39;</span>

    <span class="c"># The plugin&#39;s name (suitable for displaying to the user).</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s">&#39;Attractors&#39;</span>

    <span class="c">#### Contributions to extension points made by this plugin ############</span>

    <span class="n">tasks</span> <span class="o">=</span> <span class="n">List</span><span class="p">(</span><span class="n">contributes_to</span><span class="o">=</span><span class="s">&#39;envisage.ui.tasks.tasks&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_tasks_default</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span> <span class="n">TaskFactory</span><span class="p">(</span><span class="nb">id</span> <span class="o">=</span> <span class="s">&#39;example.attractors.task_2d&#39;</span><span class="p">,</span>
                             <span class="n">name</span> <span class="o">=</span> <span class="s">&#39;2D Visualization&#39;</span><span class="p">,</span>
                             <span class="n">factory</span> <span class="o">=</span> <span class="n">Visualize2dTask</span><span class="p">),</span>
                 <span class="n">TaskFactory</span><span class="p">(</span><span class="nb">id</span> <span class="o">=</span> <span class="s">&#39;example.attractors.task_3d&#39;</span><span class="p">,</span>
                             <span class="n">name</span> <span class="o">=</span> <span class="s">&#39;3D Visualization&#39;</span><span class="p">,</span>
                             <span class="n">factory</span> <span class="o">=</span> <span class="n">Visualize3dTask</span><span class="p">)</span> <span class="p">]</span>
</pre></div>
</div>
<p id="index-4">Having contributed tasks to the Tasks plugin, we must now specify how the tasks
shall be added to windows to constitute our application. We call this
specification the <em>application-level layout</em> to distinguish it from the
lower-level layout attached to a task. Concretely, an application-level layout
consists of a set of <tt class="docutils literal"><span class="pre">TaskWindowLayout</span></tt> objects, each of which indicates which
tasks are attached to the window, which task is active in the window, and,
optionally, the size and position of the window.</p>
<p>The default application-level layout is defined inside our application class,
which must inherit <tt class="docutils literal"><span class="pre">TasksApplication</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">AttractorsApplication</span><span class="p">(</span><span class="n">TasksApplication</span><span class="p">):</span>

    <span class="c">#### &#39;IApplication&#39; interface #########################################</span>

    <span class="c"># The application&#39;s globally unique identifier.</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="s">&#39;example.attractors&#39;</span>

    <span class="c"># The application&#39;s user-visible name.</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s">&#39;Attractors&#39;</span>

    <span class="c">#### &#39;TasksApplication&#39; interface #####################################</span>

    <span class="c"># The default application-level layout for the application.</span>
    <span class="n">default_layout</span> <span class="o">=</span> <span class="p">[</span> <span class="n">TaskWindowLayout</span><span class="p">(</span><span class="s">&#39;example.attractors.task_2d&#39;</span><span class="p">,</span>
                                        <span class="s">&#39;example.attractors.task_3d&#39;</span><span class="p">,</span>
                                        <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">600</span><span class="p">))</span> <span class="p">]</span>
</pre></div>
</div>
<p>Observe that each of the IDs specified in the layout must correspond to the ID
of a <tt class="docutils literal"><span class="pre">TaskFactory</span></tt> that has been contributed to the Tasks plugin. Also note
that the <tt class="docutils literal"><span class="pre">TaskWindowLayout</span></tt> class has an <tt class="docutils literal"><span class="pre">active_task</span></tt> attribute; by
omitting it, we indicate that the first task in the task list is to be active by
default.</p>
<p id="index-5">By default, the Tasks framework will restore application-level layout when the
application is restarted. That is, the set of windows and tasks attached to
those windows that is extant when application exits will be restored when
application is started again. If, however, the <tt class="docutils literal"><span class="pre">always_use_default_layout</span></tt>
attribute of the application is set, the default application-layout will be
applied when the application is restarted. Tasks will still attempt to restore
as much user interface state as possible, including window positions and task
layouts. This setting is partcularly useful for multi-window applications.</p>
<p>Apart from this functionality, the Tasks plugin provides no additional <em>default</em>
behavior for managing tasks and their windows, permitting users to switch tasks
within a window, etc. This is to be expected, as these behaviors are
fundamentally application-specific. That said, we shall see in
<a class="reference internal" href="#global-task-extensions"><em>Global Task Extensions</em></a> that the Tasks plugins provides a few built-in
extensions for implementing common behaviors.</p>
</div>
<div class="section" id="creating-a-preferences-dialog">
<span id="id3"></span><h2>Creating a Preferences Dialog<a class="headerlink" href="#creating-a-preferences-dialog" title="Permalink to this headline">¶</a></h2>
<p id="index-6">There are three extensions points associated with preferences. One of these
extension points is built into the Envisage core plugin, while the other two
belong to the Tasks plugin. Let us survey each of them in turn.</p>
<ol class="arabic">
<li><p class="first"><tt class="docutils literal"><span class="pre">envisage.preferences</span></tt>:</p>
<p>A list of locators for default preferences files (INI files). This extension
point is at the model level in the preferences system.</p>
</li>
</ol>
<ol class="arabic" id="index-7" start="2">
<li><p class="first"><tt class="docutils literal"><span class="pre">envisage.ui.tasks.preferences_categories</span></tt>:</p>
<p>A list of <tt class="docutils literal"><span class="pre">PreferencesCategory</span></tt> instances. Preference categories have name
and ID attributes. To each category with a given name corresponds a tab with
that name in the preferences dialog, unless there is only a single category,
in which the case the tab bar will not be shown.</p>
</li>
</ol>
<ol class="arabic" id="index-8" start="3">
<li><p class="first"><tt class="docutils literal"><span class="pre">envisage.ui.tasks.preferences_panes</span></tt>:</p>
<p>A list of <tt class="docutils literal"><span class="pre">PreferencesPane</span></tt> instances. A preferences pane defines a set of
user interface elements for changing application preferences via a model
object called a <tt class="docutils literal"><span class="pre">PreferencesHelper</span></tt>. A preferences pane has a name and an
ID, as well as a <tt class="docutils literal"><span class="pre">category</span></tt> attribute for specifying the ID of the category
to which it belongs. Preferences panes are stacked vertically among the other
panes in their category. By default, the category of a pane is &#8220;General&#8221;.
As a convenience, if a category with the specified ID does not exist, it
will be created automatically.</p>
</li>
</ol>
<p>Note that both preference panes and categories have <tt class="docutils literal"><span class="pre">before</span></tt> and <tt class="docutils literal"><span class="pre">after</span></tt>
attributes for specifying their order, if this is necessary. See the next
subsection for more information about this idiom.</p>
<p>We shall now expand the example from the previous subsection by adding a
preferences dialog for changing the default task and the application-level state
restoration behavior. By doing so, we shall see concretely how to use the
preferences system in Tasks, as well as reinforce our knowledge about
application-level layout.</p>
<p>We begin by defining &#8220;preferences.ini&#8221;, our default preferences file:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span><span class="n">example</span><span class="o">.</span><span class="n">attractors</span><span class="p">]</span>
<span class="n">default_task</span> <span class="o">=</span> <span class="n">example</span><span class="o">.</span><span class="n">attractors</span><span class="o">.</span><span class="n">task_2d</span>
<span class="n">always_use_default_layout</span> <span class="o">=</span> <span class="bp">False</span>
</pre></div>
</div>
<p>and contributing it to the Envisage core plugin:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">AttractorsPlugin</span><span class="p">(</span><span class="n">Plugin</span><span class="p">):</span>

    <span class="p">[</span> <span class="o">...</span> <span class="p">]</span>

    <span class="n">preferences</span> <span class="o">=</span> <span class="n">List</span><span class="p">(</span><span class="n">contributes_to</span><span class="o">=</span><span class="s">&#39;envisage.preferences&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_preferences_default</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span> <span class="s">&#39;pkgfile://example.attractors/preferences.ini&#39;</span> <span class="p">]</span>
</pre></div>
</div>
<p>This construction assumes that the attractors example is in Python&#8217;s path (in
the <tt class="docutils literal"><span class="pre">example.attractors</span></tt> package). Alternatively, we could have used the
&#8220;<a class="reference external" href="file://">file://</a>&#8221; prefix in conjunction with an absolute path on the local filesystem.</p>
<p>We can now define two classes: a preferences helper and preferences pane. The
preferences helper is a model-level class that makes accessing the keys in the
preferences file convenient and type safe. The preferences pane, introduced
above, exposes a Traits UI view for this helper object:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">envisage.ui.tasks.api</span> <span class="kn">import</span> <span class="n">PreferencesPane</span><span class="p">,</span> <span class="n">TaskFactory</span>
<span class="kn">from</span> <span class="nn">apptools.preferences.api</span> <span class="kn">import</span> <span class="n">PreferencesHelper</span>

<span class="k">class</span> <span class="nc">AttractorsPreferences</span><span class="p">(</span><span class="n">PreferencesHelper</span><span class="p">):</span>

    <span class="c">#### &#39;PreferencesHelper&#39; interface ####################################</span>

    <span class="c"># The path to the preference node that contains the preferences.</span>
    <span class="c"># Notice that this corresponds to the section header in our preferences</span>
    <span class="c"># file above.</span>
    <span class="n">preferences_path</span> <span class="o">=</span> <span class="s">&#39;example.attractors&#39;</span>

    <span class="c">#### Preferences ######################################################</span>

    <span class="n">default_task</span> <span class="o">=</span> <span class="n">Str</span>
    <span class="n">always_use_default_layout</span> <span class="o">=</span> <span class="n">Bool</span>

<span class="k">class</span> <span class="nc">AttractorsPreferencesPane</span><span class="p">(</span><span class="n">PreferencesPane</span><span class="p">):</span>

    <span class="c">#### &#39;PreferencesPane&#39; interface ######################################</span>

    <span class="c"># The factory to use for creating the preferences model object.</span>
    <span class="n">model_factory</span> <span class="o">=</span> <span class="n">AttractorsPreferences</span>

    <span class="c">#### &#39;AttractorsPreferencesPane&#39; interface ############################</span>

    <span class="n">task_map</span> <span class="o">=</span> <span class="n">Dict</span><span class="p">(</span><span class="n">Str</span><span class="p">,</span> <span class="n">Unicode</span><span class="p">)</span>

    <span class="c"># Notice that the default context for trait names is that of the model</span>
    <span class="c"># object, and that we must prefix names for this object with &#39;handler.&#39;.</span>
    <span class="n">view</span> <span class="o">=</span> <span class="n">View</span><span class="p">(</span><span class="n">Group</span><span class="p">(</span><span class="n">Item</span><span class="p">(</span><span class="s">&#39;always_use_default_layout&#39;</span><span class="p">),</span>
                      <span class="n">Item</span><span class="p">(</span><span class="s">&#39;default_task&#39;</span><span class="p">,</span>
                           <span class="n">editor</span> <span class="o">=</span> <span class="n">EnumEditor</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;handler.task_map&#39;</span><span class="p">),</span>
                           <span class="n">enabled_when</span> <span class="o">=</span> <span class="s">&#39;always_use_default_layout&#39;</span><span class="p">),</span>
                      <span class="n">label</span><span class="o">=</span><span class="s">&#39;Application startup&#39;</span><span class="p">),</span>
                <span class="n">resizable</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_task_map_default</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="p">((</span><span class="n">factory</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">factory</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">factory</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dialog</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">task_factories</span><span class="p">)</span>
</pre></div>
</div>
<p>Finally, we modify our application to make use of this new functionality:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">AttractorsApplication</span><span class="p">(</span><span class="n">TasksApplication</span><span class="p">):</span>

    <span class="p">[</span> <span class="o">...</span> <span class="p">]</span>

    <span class="c">#### &#39;TasksApplication&#39; interface #####################################</span>

    <span class="n">default_layout</span> <span class="o">=</span> <span class="n">List</span><span class="p">(</span><span class="n">TaskWindowLayout</span><span class="p">)</span>
    <span class="n">always_use_default_layout</span> <span class="o">=</span> <span class="n">Property</span><span class="p">(</span><span class="n">Bool</span><span class="p">)</span>

    <span class="c">#### &#39;AttractorsApplication&#39; interface ################################</span>

    <span class="n">preferences_helper</span> <span class="o">=</span> <span class="n">Instance</span><span class="p">(</span><span class="n">AttractorsPreferences</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_default_layout_default</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">active_task</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences_helper</span><span class="o">.</span><span class="n">default_task</span>
        <span class="n">tasks</span> <span class="o">=</span> <span class="p">[</span> <span class="n">factory</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">factory</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">task_factories</span> <span class="p">]</span>
        <span class="k">return</span> <span class="p">[</span> <span class="n">TaskWindowLayout</span><span class="p">(</span><span class="o">*</span><span class="n">tasks</span><span class="p">,</span>
                                  <span class="n">active_task</span> <span class="o">=</span> <span class="n">active_task</span><span class="p">,</span>
                                  <span class="n">size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">600</span><span class="p">))</span> <span class="p">]</span>

    <span class="k">def</span> <span class="nf">_get_always_use_default_layout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences_helper</span><span class="o">.</span><span class="n">always_use_default_layout</span>

    <span class="k">def</span> <span class="nf">_preferences_helper_default</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">AttractorsPreferences</span><span class="p">(</span><span class="n">preferences</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="p">)</span>
</pre></div>
</div>
<p>and contribute the preferences pane to the Tasks plugin:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">AttractorsPlugin</span><span class="p">(</span><span class="n">Plugin</span><span class="p">):</span>

    <span class="p">[</span> <span class="o">...</span> <span class="p">]</span>

    <span class="n">preferences_panes</span> <span class="o">=</span> <span class="n">List</span><span class="p">(</span>
        <span class="n">contributes_to</span><span class="o">=</span><span class="s">&#39;envisage.ui.tasks.preferences_panes&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_preferences_panes_default</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
       <span class="k">return</span> <span class="p">[</span> <span class="n">AttractorsPreferencesPane</span> <span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="extending-an-existing-task">
<span id="extending-a-task"></span><h2>Extending an Existing Task<a class="headerlink" href="#extending-an-existing-task" title="Permalink to this headline">¶</a></h2>
<p>Contributions are made to an existing task via the <tt class="docutils literal"><span class="pre">TaskExtension</span></tt> class,
which was briefly introduced above. <tt class="docutils literal"><span class="pre">TaskExtension</span></tt> is a simple class with
three attributes:</p>
<ol class="arabic simple">
<li><tt class="docutils literal"><span class="pre">task_id</span></tt>: The ID of the task to extend.</li>
<li><tt class="docutils literal"><span class="pre">actions</span></tt>: A list of <tt class="docutils literal"><span class="pre">SchemaAddition</span></tt> objects.</li>
<li><tt class="docutils literal"><span class="pre">dock_pane_factories</span></tt>: A list of callables for creating dock panes.</li>
</ol>
<p id="index-9">The second attributes requires further discussion. In the previous section, we
remarked that a task&#8217;s menu and tool bars are defined using schemas; the
<tt class="docutils literal"><span class="pre">SchemaAddition</span></tt> class provides a mechanism for inserting new items into these
schemas.</p>
<p id="index-10">A schema implicitly defines a <em>path</em> for each of its elements. For example, in
the schema:</p>
<div class="highlight-python"><pre>SMenuBar(SMenu(SGroup([ ... ],
                      id = 'SaveGroup'),
               [ ... ],
               id = 'File', name = '&amp;File),
         SMenu([ ... ],
               id = 'Edit', name = '&amp;Edit'))</pre>
</div>
<p>the edit menu has the path &#8220;MenuBar/Edit&#8221;. Likewise, the save group in the file
menu has the path &#8220;MenuBar/File/SaveGroup&#8221;. We might define an addition for this
menu as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">SchemaAddition</span><span class="p">(</span><span class="n">factory</span> <span class="o">=</span> <span class="n">MyContributedGroup</span><span class="p">,</span>
               <span class="n">path</span> <span class="o">=</span> <span class="s">&#39;MenuBar/File&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>where <tt class="docutils literal"><span class="pre">factory</span></tt> is a callable that produces either a schema or an object from
the PyFace action API <a class="footnote-reference" href="#id8" id="id4">[2]</a>. A schema addition that produces a schema can in turn
be extended by another schema addition. If it produces a PyFace object, it
cannot be further extended. In this case we have opted for latter, using a
custom subclass of <tt class="docutils literal"><span class="pre">Group</span></tt>.</p>
<p id="index-11">The group created from the schema addition above would be inserted at the bottom
of the file menu. The <tt class="docutils literal"><span class="pre">SchemaAddition</span></tt> class provides two further attributes
for specifying with greater precision the location of the insertion: <tt class="docutils literal"><span class="pre">before</span></tt>
and <tt class="docutils literal"><span class="pre">after</span></tt>. Setting one of these attributes to the ID of a schema with the
same path ensures that the insertion will be made before or after, respectively,
that schema. For example, in the expanded addition:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">SchemaAddition</span><span class="p">(</span><span class="n">factory</span> <span class="o">=</span> <span class="n">MyContributedGroup</span><span class="p">,</span>
               <span class="n">before</span> <span class="o">=</span> <span class="s">&#39;SaveGroup&#39;</span><span class="p">,</span>
               <span class="n">path</span> <span class="o">=</span> <span class="s">&#39;MenuBar/File&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>the created group would be inserted before the save group. If both <tt class="docutils literal"><span class="pre">before</span></tt>
and <tt class="docutils literal"><span class="pre">after</span></tt> are set, Tasks will attempt to honor both of them <a class="footnote-reference" href="#id9" id="id5">[3]</a>. In the
event that Tasks cannot, the menu order is undefined (although the insertions
are guaranteed to made) and an error is logged.</p>
</div>
<div class="section" id="global-task-extensions">
<span id="id6"></span><h2>Global Task Extensions<a class="headerlink" href="#global-task-extensions" title="Permalink to this headline">¶</a></h2>
<p id="index-12">When creating an application with several tasks it is frequently the case that
certain menu bar or tool bar actions should be present in all tasks. Such
actions might include an &#8220;Exit&#8221; item in the &#8220;File&#8221; menu or an &#8220;About&#8221; item in
the &#8220;Help&#8221; menu. One can, of course, include these items in the schemas of each
task; indeed, if the actions require task-specific behavior, this is the only
reasonable approach to take. But for actions that are truly global in nature
Tasks provides an alternative that may be more convenient.</p>
<p>To create a <tt class="docutils literal"><span class="pre">TaskExtension</span></tt> that applies to all tasks, simply omit the
<tt class="docutils literal"><span class="pre">task_id</span></tt> attribute. Tasks itself contributes a global task extension with the
following menu items:</p>
<ul class="simple">
<li>A group of actions in the menu with ID &#8220;View&#8221; for toggling the visibility of
dock panes (see <tt class="docutils literal"><span class="pre">pyface.tasks.action.api.DockPaneToggleGroup</span></tt>)</li>
<li>A &#8220;Preferences&#8221; action in the menu with ID &#8220;Edit&#8221;, if the application has any
preferences panes</li>
<li>An &#8220;Exit&#8221; action in the menu with ID &#8220;File&#8221;</li>
</ul>
<p>The user is free to supplement these items by contributing additional global
task extensions. For example, to provide a simple mechanism for changing tasks,
one might add include the built-in task switching group in the &#8220;View&#8221; menu,
either at the toplevel or as a sub-menu (see
<tt class="docutils literal"><span class="pre">pyface.tasks.action.api.TaskToggleGroup</span></tt>). For switching between
windows, Tasks includes the <tt class="docutils literal"><span class="pre">TaskWindowToggleGroup</span></tt>. This class, as well as
several other menu-related conveniences, can be found in
<tt class="docutils literal"><span class="pre">envisage.ui.tasks.action.api</span></tt>.</p>
<p class="rubric">Footnotes</p>
<table class="docutils footnote" frame="void" id="id7" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[1]</a></td><td>In this section, we shall be referencing&#8211;often with considerable
simplification&#8211;the Attractors example code in the EnvisagePlugins
package, available <a class="reference external" href="https://github.com/enthought/envisageplugins/tree/master/examples/tasks/attractors">online</a>
and in the ETS distribution.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id8" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[2]</a></td><td>Although they are expanded into PyFace action items, schemas belong to a
distinct API. It is beyond the scope of this document to describe the
PyFace action API. For lack of more complete documentation, the reader is
referred to the <a class="reference external" href="https://github.com/enthought/traitsgui/blob/master/enthought/pyface/action/">source code</a>.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id9" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[3]</a></td><td>Tasks differs from the Workbench in this regard.</td></tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/e-logo-rev.png" alt="Logo"/>
            </a></p>
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Extensibility</a><ul>
<li><a class="reference internal" href="#the-tasks-plugin">The Tasks Plugin</a></li>
<li><a class="reference internal" href="#creating-a-tasks-application">Creating a Tasks Application</a></li>
<li><a class="reference internal" href="#creating-a-preferences-dialog">Creating a Preferences Dialog</a></li>
<li><a class="reference internal" href="#extending-an-existing-task">Extending an Existing Task</a></li>
<li><a class="reference internal" href="#global-task-extensions">Global Task Extensions</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="menus.html"
                        title="previous chapter">Menus and Tool Bars</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/tasks_user_manual/extensibility.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="menus.html" title="Menus and Tool Bars"
             >previous</a> |</li>
        <li><a href="../index.html">Envisage Documentation</a> &raquo;</li>
          <li><a href="index.html" >Tasks User Manual</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2008-2011, Enthought.
      Last updated on Nov 11, 2013.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2b3.
    </div>
  </body>
</html>